<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Settings</title>
    <link rel="stylesheet" type="text/css" href="/css/style.css">
</head>
<body>

<div th:replace="~{fragments/navbar :: navbar}"></div>

<div class="settings-container">
    <button type="button" onclick="document.getElementById('changePasswordForm').style.display='block'">Change password</button>

    <form id="changePasswordForm" th:action="@{/change-password}" method="post" style="display: none; margin-top: 20px;">
        <label for="oldPassword">Old Password:</label>
        <input type="password" name="oldPassword" required><br>

        <label for="newPassword">New Password:</label>
        <input type="password" name="newPassword" required><br>
        <br>
        <button type="submit">Submit</button>
    </form>

    <form th:action="@{/delete-my-account}" method="post"
          onsubmit="return confirm('Are you sure you want to delete your account? This action cannot be undone.');"
          style="margin-top: 20px;">
        <button type="submit" class="btn btn-danger">Delete My Account</button>
    </form>

    <div th:if="${param.error}" class="error-message" style="color: red; margin-top: 10px;">
        <span th:if="${param.error == 'deletion-failed'}">Failed to delete account. Please try again or contact support.</span>
    </div>

    <button type="button" onclick="location.href='/logout'" style="margin-top: 20px;">Logout</button>
    <button type="button" onclick="location.href='/index'" style="margin-top: 10px;">Back to home</button>
</div>

<script>
    function showChangePasswordForm() {
        document.getElementById("changePasswordForm").style.display = "block";
    }
</script>

</body>
</html>
